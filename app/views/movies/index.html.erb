<h1>Listing movies</h1>

<div class="row">
  <div class="pull-right">
    <%= render 'filter', :resource => @search %>
  </div>
</div>

<table id="movie_list">
  <colgroup>
    <col />
    <col width="*" />
    <col />
    <col />
    <col />
    <col width="400" />
  </colgroup>
  <tr>
    <th></th>
    <th><%= sort_link @search, :name, "Name", {:page => params[:page]} %></th>
    <th><%= sort_link @search, :rating, "Rating", {:page => params[:page]} %></th>
    <th><%= sort_link @search, :length, "Length", {:page => params[:page]} %></th>
    <th><%= sort_link @search, :year, "Year", {:page => params[:page]} %></th>
    <th></th>
  </tr>

<% @movies.each do |movie| %>
  <tr>
    <td>
      <% if movie.poster_url %>
        <!-- <a href="<%= movie.poster_url %>"><img src="<%= movie.poster_url %>" alt="<%= movie.name %>" style="height: 100px;" rel="lightbox" / ></a> -->
        <%= lightbox_tag(movie.poster_url, movie.poster_url, title=movie.name, collection="movies", html_options = {:class => "poster_lightbox"}) %>
      <% end %>
    </td>
    <td colspan="4">
      <div class="title">
        <span class="name"><%= movie.name %></span> (<%= movie.year %>) <a target="_blank" href="<%= movie.youtube_trailer_url %>"><i class="icon icon-film"></i></a>
      </div>
      <div class="tagline">
        <small><%= movie.tagline.html_safe unless movie.tagline.nil? %></small>
      </div>
      <div class="lenght">
        <%= Time.at(movie.length * 60).utc.strftime("%kh %Mmin") %> - <i class="icon icon-star-empty"></i> <%= movie.rating %> <small>(<%= movie.votes %>)</small>
      </div>
      <div class="genres">
        <% movie.genres.each do |genre| %>
          <span class="label label-info"><%= genre.name %></span>
        <% end %>
      </div>
      <div class="plot_sumary">
        <small><%= h truncate(movie.plot_summary, :length => 300) %></small>
      </div>
      <div class="operators">
        <a target="_blank" href="file://<%= movie.full_path %>"><i class="icon icon-folder-open"></i></a>
        <%= link_to '<i class="icon icon-eye-open"></i>'.html_safe, movie %>
        <%= link_to '<i class="icon icon-edit"></i>'.html_safe, edit_movie_path(movie) %>
        <%= link_to '<i class="icon icon-remove"></i>'.html_safe, movie, method: :delete, data: { confirm: 'Are you sure?' } %>
      </div>
    </td>
    <td><%= movie.plot unless movie.plot.nil? %></td>
  </tr>
<% end %>
</table>

<%= will_paginate @movies, :renderer => BootstrapPagination::Rails, :previous_label => "&#8249;", :next_label => "&#8250;" %>
